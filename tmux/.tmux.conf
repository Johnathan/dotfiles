# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'b0o/tmux-autoreload'
set -g @plugin 'sainnhe/tmux-fzf'

set -g default-terminal "tmux-256color"

# Use Vi mode
setw -g mode-keys vi

# Increase scrollback buffer size
set -g history-limit 10000

# Allow automatic renaming of windows
set -g allow-rename on

# Enable undercurl
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'

# Enable undercurl colors
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# Enable hyperlinks
set -as terminal-overrides ',*:Hls=\E]8;id=%p1%s;%p2%s\E\\:Hlr=\E]8;;\E\\'

# Cheating and using a mouse
setw -g mouse on

# Click session name to switch to it
bind-key -T root MouseDown1Status run-shell -b '~/dotfiles/scripts/tmux-switch-session.sh "#{mouse_status_range}"'

# Allow tmux to set the terminal title
set -g set-titles on

# Enable remain-on-exit so dead panes stay visible with exit status
set-option -g remain-on-exit on

set-option -g detach-on-destroy off

# Monitor window activity to display in the status bar
setw -g monitor-activity on

# A bell in another window should cause a bell in the current window
set -g bell-action any

# Don't show distracting notifications
set -g visual-bell off
set -g visual-activity off

# Focus events enabled for terminals that support them
set -g focus-events on

# Unbind Ctrl-B as the Prefix Key
unbind C-b

# Prefix: Ctrl-a on macOS, Ctrl-s on Linux
if-shell "uname | grep -q Darwin" \
    "set -g prefix C-a; bind C-a send-prefix" \
    "set -g prefix C-s; bind C-s send-prefix"

# Makes it super responsive
set -s escape-time 0

# Pass through Alt/Option key sequences to applications
set -s extended-keys on
set -as terminal-features 'xterm*:extkeys'

# Reloads tmux.conf and displays success message when it's done
bind r source-file ~/.tmux.conf \; display-message "Reloaded!"

# Create a horizontal Split
bind - split-window -v

# Create a vertical Split
bind | split-window -h

# Pane Movement Keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# New window with name prompt
bind c new-window \; command-prompt -p "window name:" "rename-window '%%'"

# Pane Resizing
bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5

# Status line customisation
set-option -g status-left-length 100
set-option -g status-right-length 100

# Show all sessions in status-left (clickable, with windows for active session)
set-option -g status-left "#{S:#[range=user|#{session_name}]#{?session_attached,#[fg=#c0caf5 bold]#{session_name}#[norange nobold] #[fg=#c0caf5][#[fg=#737aa2]#{W:#[range=user|w#{window_index}]#{?window_active,#[fg=#c0caf5],}#{window_name}#[fg=#737aa2]#[norange] }#[fg=#c0caf5]],#[fg=#737aa2 nobold]#{session_name}#[norange]}   }  "
# set-option -g status-left " " # Screencast mode

set-option -g status-right "#{pane_title} "
# set-option -g status-right " " # Screencast mode

# set-option -g status-style "fg=#545c7e bg=#1f2335"
set-option -g status-style "fg=#545c7e bg=default" # Screencast mode
set-option -g status-left-style default
set-option -g status-right-style default

# Window formats (hidden - windows shown in status-left with sessions)
set-option -g window-status-format ""
set-option -g window-status-current-format ""
#set-option -g window-status-format "· " # Screencast mode
#set-option -g window-status-current-format "· " # Screencast mode

set-option -g window-status-current-style "fg=#E9E9EA"
set-option -g window-status-activity-style none

# Pane Borders
set -g pane-border-style "fg=#565f89"
set -g pane-active-border-style "fg=#7aa2f7"

# Message Style
set -g message-style "fg=#1a1a1a,bg=#87ceeb,bold"

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'
